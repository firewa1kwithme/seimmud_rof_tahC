<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css" />
<meta charset="utf-8">
	<script type="text/javascript">
		window.onload = function() {
			var btnConnect = document.getElementById('btn_connect');
			var btnSend = document.getElementById('btn_ok');
			var inptMes = document.getElementById('inpt_mes');
			var messagesField = document.getElementById('messages_field');
			var socket;

			function addMessage(message, isIncoming) {
				var div = document.createElement('div');
				if (isIncoming) {
					div.className = "incoming_message";
				} else {
					div.className = "outcoming_message";
				}
				div.innerText = message;
				messagesField.appendChild(div);
			};

			function isNotEmpty(n) {
				return !(n[0] == " ") && n.length > 1;
			};

			btnConnect.addEventListener('click', function() {

				var inptIP = document.getElementById('input_IP');
				var inptUsername = document.getElementById('input_username');
				var usernameH1 = document.querySelector("#user_info h1");
				socket = new WebSocket(inptIP.value);

				socket.onopen = function() {
					usernameH1.innerHTML = inptUsername.value + '<span style="color: #33ff33;" class="italic_text"> (online)';
				};

				socket.onclose = function() {
					usernameH1.innerHTML = inptUsername.value + '<span style="color: red;" class="italic_text"> (offline)';
				};

				socket.onmessage = function(event) {
					addMessage(event.data, true);
				};
			});

			btnSend.addEventListener('click', function() {
				if (isNotEmpty(inptMes.value)) {
					addMessage(inptMes.value, false);
					socket.send(inptMes.value);
					inptMes.value = '';
					socket.send(inptMes.value);
				} else {
					inptMes.value = '';
				}
			});

			inptMes.addEventListener("keyup", function(event) {
				event.preventDefault();
				if (event.keyCode == 13) {
					btnSend.click();
				}
			});

		}

	</script>
</head>
<body>
	<div id="page_header">
		<div id="input_connection">
			<input type="text" id="input_IP" class="start_input_fields" placeholder="IP..."></input>
			<input id="input_username" class="start_input_fields" type="text" placeholder="Username..."></input>
			<button id="btn_connect" class="buttons">Connect </button>
		</div>
		<div id="user_info">
			<h1>Connection...</h1>
		</div>
	</div>
	<div id="page_body">
		<div id="messages_field" class="out_message in_message"/></div>
		<div id="chat_input_block">
			<input id="inpt_mes" type="text"></input>
			<button id="btn_ok" class="buttons">Send</button>
		</div>
		<div id="contact_menu">
			<div class="contact_block_style">
				<h1>Mama Prosti</h1>
			</div>
			<div class="contact_block_style">
				<h1>Шарамок</h1>
			</div>
			<div class="contact_block_style">
				<h1>Good Boy</h1>
			</div>
			<div class="contact_block_style">
				<h1>Шива</h1>
			</div>
			<div class="contact_block_style">
				<h1>Телка из Томска</h1>
			</div>
			<div class="contact_block_style">
				<h1>BBNG</h1>
			</div>
			<div class="contact_block_style">
				<h1>Putin</h1>
			</div>
			<div class="contact_block_style">
				<h1>Navalny</h1>
			</div>
			<div class="contact_block_style">
				<h1>Cooper</h1>
			</div>
			<div class="contact_block_style">
				<h1>Дени</h1>
			</div>
			<div class="contact_block_style">
				<h1>Rick</h1>
			</div>
			<div class="contact_block_style">
				<h1>02</h1>
			</div>
			<div class="contact_block_style">
				<h1>41</h1>
			</div>
			<div class="contact_block_style">
				<h1>Дядя Деда</h1>
			</div>
			<div class="contact_block_style">
				<h1>Дюймовочка</h1>
			</div>
			<div class="contact_block_style">
				<h1>Лучший друг</h1>
			</div>
			<div class="contact_block_style">
				<h1>Огурчик</h1>
			</div>
		</div>
	</div>
</body>
</html>